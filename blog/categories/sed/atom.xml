<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: sed | Wright Access]]></title>
  <link href="http://dpwright.github.com/blog/categories/sed/atom.xml" rel="self"/>
  <link href="http://dpwright.github.com/"/>
  <updated>2012-09-28T19:21:44+09:00</updated>
  <id>http://dpwright.github.com/</id>
  <author>
    <name><![CDATA[Daniel P. Wright]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Invoking ex commands on a subset of files]]></title>
    <link href="http://dpwright.github.com/blog/2012/04/17/invoking-ex-commands-on-a-subset-of-files/"/>
    <updated>2012-04-17T10:02:00+09:00</updated>
    <id>http://dpwright.github.com/blog/2012/04/17/invoking-ex-commands-on-a-subset-of-files</id>
    <content type="html"><![CDATA[<p>I use <code>sed</code> a lot for modifications I need to make to a number of
files, which is great, but as it happens relatively infrequently I need to
remind myself how to do certain things as and when I come across them.</p>

<p>On the other hand, I use <code>vim</code> every day for my general editing, and
am making increasingly heavy use of its command syntax to automate some of my
editing tasks.  As a result, I am probably more familiar with <code>vim</code>'s
command syntax than <code>sed</code>.</p>

<p>Yesterday I had a simple problem to solve: for every file containing string
SEARCH, I wanted to delete any line matching LINE.  Here's a couple of ways you
could do it using sed:</p>

<p><div><script src='https://gist.github.com/2402616.js?file=selectivelydelete-sed.sh'></script>
<noscript><pre><code>grep -Rl &quot;SEARCH&quot; . | while read FILE; do sed -i &quot;&quot; &quot;/LINE/d&quot; $FILE; done
grep -Rl &quot;SEARCH&quot; . | while read FILE; do sed &quot;/LINE/d&quot; $FILE &gt; tmp; mv tmp $FILE ; done</code></pre></noscript></div>
</p>

<p>The first is non-portable and works with BSD <code>sed</code>; for GNU
<code>sed</code> you'd have to remove the "" after the -i.  The second is a
little more portable but requires a temporary file.</p>

<p>Just for kicks, though, I thought I'd do it in <code>ex</code> this time. 
Here's how that looks:</p>

<p><div><script src='https://gist.github.com/2402657.js?file=selectivelydelete-ex.sh'></script>
<noscript><pre><code>grep -Rl &quot;SEARCH&quot; . | while read FILE; do (echo &quot;g/LINE/d&quot;; echo 'wq') | ex -s FILE; done</code></pre></noscript></div>
</p>

<p>Admittedly, for a simple task like this it's probably pointless, but there have
been times where I've repeated a command in <code>vim</code> over a series of
files where this might come in ha</p>
]]></content>
  </entry>
  
</feed>
